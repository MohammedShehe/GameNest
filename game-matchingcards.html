<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <link rel="icon" href="assets/images/logo.png" type="image/png">
    <title>Matching Cards - GameNest</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* CSS Variables */
        :root {
            --primary-color: #6c5ce7;
            --secondary-color: #a29bfe;
            --accent-color: #fd79a8;
            --accent-glow: rgba(253, 121, 168, 0.6);
            --dark-color: #2d3436;
            --light-color: #dfe6e9;
            --success-color: #00b894;
            --success-glow: rgba(0, 184, 148, 0.6);
            --warning-color: #fdcb6e;
            --danger-color: #e17055;
            --card-bg: rgba(255, 255, 255, 0.1);
            --card-glow: rgba(255, 255, 255, 0.15);
            --card-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            --border-radius: 20px;
            --transition: all 0.3s ease;
            --game-bg: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            --neon-glow: 0 0 10px currentColor, 0 0 20px currentColor, 0 0 30px currentColor;
        }

        /* Reset and Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800;900&display=swap');

        body {
            font-family: 'Poppins', sans-serif;
            background: var(--game-bg);
            color: white;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 80%, rgba(120, 119, 198, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255, 107, 107, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(77, 201, 208, 0.05) 0%, transparent 50%);
            z-index: -1;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Fixed Navigation Buttons */
        .fixed-back-btn, .fixed-exit-btn {
            position: fixed;
            top: 30px;
            width: 55px;
            height: 55px;
            border-radius: 50%;
            background: var(--card-bg);
            border: 1px solid var(--card-glow);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.3rem;
            cursor: pointer;
            transition: var(--transition);
            backdrop-filter: blur(15px);
            box-shadow: var(--card-shadow);
            z-index: 1000;
        }

        .fixed-back-btn {
            left: 30px;
        }

        .fixed-exit-btn {
            right: 30px;
        }

        .fixed-back-btn:hover, .fixed-exit-btn:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
            background: rgba(255, 255, 255, 0.15);
        }

        /* Header Styles */
        .page-header {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 10px 0;
            margin-bottom: 30px;
        }

        .header-center h1 {
            font-size: 2.2rem;
            font-weight: 800;
            text-align: center;
            background: linear-gradient(to right, #a29bfe, #fd79a8, #00b894);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            letter-spacing: 1px;
            position: relative;
            padding-bottom: 10px;
        }

        .header-center h1::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 3px;
            background: linear-gradient(to right, #a29bfe, #fd79a8, #00b894);
            border-radius: 3px;
        }

        /* Matching Cards Game Specific Styles */
        .matching-cards-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            padding: 10px;
            touch-action: manipulation;
            -webkit-tap-highlight-color: transparent;
            overflow: hidden;
        }

        .game-header {
            text-align: center;
            margin-bottom: 25px;
            width: 100%;
        }

        .game-title {
            font-size: 3rem;
            margin-bottom: 15px;
            background: linear-gradient(to right, #00b894, #55efc4, #81ecec);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            font-weight: 900;
            letter-spacing: 1px;
            position: relative;
            display: inline-block;
        }

        .game-title::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 150px;
            height: 4px;
            background: linear-gradient(to right, #00b894, #55efc4, #81ecec);
            border-radius: 4px;
            box-shadow: 0 0 10px rgba(0, 184, 148, 0.5);
        }

        .game-stats {
            display: flex;
            justify-content: center;
            gap: 25px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .stat {
            background: var(--card-bg);
            backdrop-filter: blur(15px);
            padding: 15px 20px;
            border-radius: var(--border-radius);
            box-shadow: var(--card-shadow);
            min-width: 120px;
            text-align: center;
            border: 1px solid var(--card-glow);
            position: relative;
            overflow: hidden;
            transition: var(--transition);
        }

        .stat:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.3);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 800;
            color: #00b894;
            text-shadow: 0 0 10px var(--success-glow);
            position: relative;
            z-index: 1;
        }

        .stat-label {
            font-size: 0.9rem;
            opacity: 0.9;
            letter-spacing: 1px;
            position: relative;
            z-index: 1;
        }

        .game-area {
            position: relative;
            margin: 20px 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
            max-height: 70vh;
            overflow-y: auto;
            padding: 10px;
        }

        .cards-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            max-width: 600px;
            width: 100%;
            margin: 0 auto;
            padding: 10px;
        }

        .card {
            aspect-ratio: 3/4;
            background: linear-gradient(135deg, #6c5ce7, #a29bfe);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
            transform-style: preserve-3d;
            position: relative;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
            border: 2px solid rgba(255, 255, 255, 0.1);
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 30px rgba(108, 92, 231, 0.4);
        }

        .card.flipped {
            transform: rotateY(180deg);
        }

        .card.matched {
            transform: scale(0.95);
            box-shadow: 0 0 20px rgba(0, 184, 148, 0.7);
            border-color: #00b894;
            animation: matchSuccess 0.5s ease;
        }

        .card-front, .card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 13px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .card-front {
            background: linear-gradient(135deg, #2d3436, #636e72);
            transform: rotateY(180deg);
            font-size: 2.5rem;
            color: white;
            overflow: hidden;
        }

        .card-front img {
            width: 80%;
            height: 80%;
            object-fit: contain;
            border-radius: 10px;
        }

        .card-back {
            background: linear-gradient(135deg, #6c5ce7, #a29bfe);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .card-back i {
            font-size: 2rem;
            color: rgba(255, 255, 255, 0.8);
        }

        .game-controls {
            display: flex;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .control-btn {
            padding: 15px 25px;
            border: none;
            border-radius: var(--border-radius);
            background: var(--card-bg);
            backdrop-filter: blur(15px);
            color: white;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: var(--card-shadow);
            -webkit-tap-highlight-color: transparent;
            user-select: none;
            border: 1px solid var(--card-glow);
        }

        .control-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.3);
        }

        .control-btn:active {
            transform: translateY(2px);
        }

        .control-btn.primary {
            background: linear-gradient(135deg, #00b894, #55efc4);
            box-shadow: 0 8px 25px rgba(0, 184, 148, 0.4);
            border: none;
        }

        .control-btn.primary:hover {
            box-shadow: 0 12px 30px rgba(0, 184, 148, 0.6);
        }

        .control-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .control-btn:disabled:hover {
            transform: none;
            box-shadow: var(--card-shadow);
        }

        .game-instructions {
            background: var(--card-bg);
            backdrop-filter: blur(15px);
            padding: 20px;
            border-radius: var(--border-radius);
            margin-top: 25px;
            max-width: 550px;
            box-shadow: var(--card-shadow);
            border: 1px solid var(--card-glow);
            position: relative;
            overflow: hidden;
        }

        .game-instructions::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 5px;
            height: 100%;
            background: linear-gradient(to bottom, #00b894, #55efc4);
        }

        .game-instructions h3 {
            margin-bottom: 15px;
            color: #00b894;
            font-size: 1.3rem;
            font-weight: 700;
            text-shadow: 0 0 10px rgba(0, 184, 148, 0.5);
        }

        .instructions-list {
            list-style-type: none;
            padding: 0;
        }

        .instructions-list li {
            margin-bottom: 10px;
            padding-left: 25px;
            position: relative;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .instructions-list li:before {
            content: '▶';
            color: #00b894;
            font-size: 0.8rem;
            position: absolute;
            left: 0;
            top: 2px;
            text-shadow: 0 0 5px rgba(0, 184, 148, 0.7);
        }

        /* Game Over Modal */
        .game-over-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(10px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
        }

        .game-over-modal.active {
            display: flex;
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            padding: 35px;
            border-radius: var(--border-radius);
            text-align: center;
            max-width: 400px;
            width: 90%;
            box-shadow: 
                0 20px 50px rgba(0, 0, 0, 0.5),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            transform: scale(0.9) translateY(20px);
            transition: transform 0.4s ease, opacity 0.4s ease;
            border: 1px solid var(--card-glow);
            position: relative;
            overflow: hidden;
        }

        .modal-content::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: linear-gradient(to right, #fd79a8, #e17055);
        }

        .game-over-modal.active .modal-content {
            transform: scale(1) translateY(0);
        }

        .modal-content h2 {
            font-size: 2.2rem;
            margin-bottom: 15px;
            color: #fd79a8;
            text-shadow: 0 0 10px var(--accent-glow);
            font-weight: 800;
        }

        .final-score {
            font-size: 3.5rem;
            font-weight: 900;
            color: #00b894;
            margin: 20px 0;
            text-shadow: 0 0 15px var(--success-glow);
        }

        .score-breakdown {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin: 15px 0;
            padding: 15px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
        }

        .score-item {
            display: flex;
            justify-content: space-between;
            font-size: 0.9rem;
        }

        .score-label {
            color: #a29bfe;
        }

        .score-value {
            color: #00b894;
            font-weight: 600;
        }

        .modal-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 25px;
        }

        /* Game Setup Modal */
        .game-setup-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
        }

        .setup-content {
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            padding: 35px;
            border-radius: var(--border-radius);
            text-align: center;
            max-width: 500px;
            width: 90%;
            box-shadow: 
                0 20px 50px rgba(0, 0, 0, 0.5),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            border: 1px solid var(--card-glow);
            position: relative;
            overflow: hidden;
        }

        .setup-content::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: linear-gradient(to right, #00b894, #55efc4);
        }

        .setup-content h2 {
            font-size: 2.2rem;
            margin-bottom: 25px;
            color: #00b894;
            text-shadow: 0 0 10px var(--success-glow);
            font-weight: 800;
        }

        .setup-options {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-bottom: 30px;
        }

        .option-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .option-group label {
            font-size: 1.1rem;
            font-weight: 600;
            color: #a29bfe;
            text-align: left;
        }

        .difficulty-options {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .difficulty-option {
            padding: 12px 20px;
            border-radius: var(--border-radius);
            background: var(--card-bg);
            border: 1px solid var(--card-glow);
            color: white;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 600;
        }

        .difficulty-option:hover {
            transform: translateY(-3px);
            background: rgba(255, 255, 255, 0.1);
        }

        .difficulty-option.selected {
            background: linear-gradient(135deg, #00b894, #55efc4);
            box-shadow: 0 5px 15px rgba(0, 184, 148, 0.4);
            border: none;
        }

        /* Theme Options */
        .theme-options {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .theme-option {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            cursor: pointer;
            transition: var(--transition);
            border: 3px solid transparent;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
        }

        .theme-option.default {
            background: linear-gradient(135deg, #6c5ce7, #a29bfe);
            box-shadow: 0 5px 15px rgba(108, 92, 231, 0.4);
        }

        .theme-option.nature {
            background: linear-gradient(135deg, #00b894, #55efc4);
            box-shadow: 0 5px 15px rgba(0, 184, 148, 0.4);
        }

        .theme-option.fruit {
            background: linear-gradient(135deg, #fd79a8, #e17055);
            box-shadow: 0 5px 15px rgba(253, 121, 168, 0.4);
        }

        .theme-option.space {
            background: linear-gradient(135deg, #0984e3, #74b9ff);
            box-shadow: 0 5px 15px rgba(9, 132, 227, 0.4);
        }

        .theme-option.selected {
            transform: scale(1.1);
            border-color: #00b894;
            box-shadow: 0 0 20px rgba(0, 184, 148, 0.7);
        }

        /* Bot Assistant Styles */
        .bot-container {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
        }

        .bot-toggle {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            border: none;
            color: white;
            font-size: 2rem;
            cursor: pointer;
            box-shadow: 
                0 6px 25px rgba(108, 92, 231, 0.5),
                0 0 15px rgba(108, 92, 231, 0.6);
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            animation: pulse 2s infinite;
        }

        .bot-toggle:hover {
            transform: scale(1.1) rotate(5deg);
            box-shadow: 
                0 8px 30px rgba(108, 92, 231, 0.7),
                0 0 20px rgba(108, 92, 231, 0.8);
        }

        .bot-assistant {
            position: absolute;
            bottom: 90px;
            right: 0;
            width: 350px;
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            border-radius: var(--border-radius);
            box-shadow: var(--card-shadow);
            overflow: hidden;
            transform: translateY(20px) scale(0.95);
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
            border: 1px solid var(--card-glow);
        }

        .bot-assistant.active {
            transform: translateY(0) scale(1);
            opacity: 1;
            visibility: visible;
        }

        .bot-header {
            padding: 18px 25px;
            background: rgba(0, 0, 0, 0.3);
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--card-glow);
        }

        .bot-header h3 {
            font-size: 1.3rem;
            font-weight: 700;
        }

        .bot-close {
            background: none;
            border: none;
            color: white;
            font-size: 1.3rem;
            cursor: pointer;
            transition: var(--transition);
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .bot-close:hover {
            transform: rotate(90deg);
            background: rgba(255, 255, 255, 0.1);
        }

        .bot-content {
            padding: 25px;
        }

        .bot-messages {
            margin-bottom: 25px;
            max-height: 220px;
            overflow-y: auto;
            padding-right: 10px;
        }

        .bot-messages::-webkit-scrollbar {
            width: 5px;
        }

        .bot-messages::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
        }

        .bot-message {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px 18px;
            border-radius: 15px;
            margin-bottom: 12px;
            border-left: 3px solid #00b894;
        }

        .bot-message p {
            margin: 0;
            line-height: 1.5;
            font-size: 0.95rem;
        }

        .bot-questions {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .bot-question {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            padding: 14px 18px;
            border-radius: 12px;
            color: white;
            text-align: left;
            cursor: pointer;
            transition: var(--transition);
            font-size: 0.95rem;
            width: 100%;
            border: 1px solid transparent;
        }

        .bot-question:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateX(5px);
            border-color: rgba(255, 255, 255, 0.1);
        }

        /* Music Toggle Styles */
        .music-toggle {
            position: fixed;
            bottom: 30px;
            left: 30px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--card-bg);
            border: 1px solid var(--card-glow);
            color: white;
            font-size: 1.4rem;
            cursor: pointer;
            backdrop-filter: blur(15px);
            box-shadow: var(--card-shadow);
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1001;
        }

        .music-toggle:hover {
            transform: scale(1.1);
            background: rgba(255, 255, 255, 0.15);
        }

        .music-toggle.playing {
            background: var(--accent-color);
            animation: musicPulse 2s infinite;
        }

        /* Timer Styles */
        .timer {
            font-size: 1.5rem;
            font-weight: 700;
            color: #00b894;
            text-shadow: 0 0 10px var(--success-glow);
            margin-bottom: 10px;
        }

        /* Time Challenge Styles */
        .time-challenge {
            font-size: 1rem;
            color: #fd79a8;
            margin-top: 5px;
            font-weight: 600;
        }

        .time-critical {
            color: #e17055;
            animation: pulse 1s infinite;
        }

        /* Typing animation */
        .typing-cursor {
            display: inline-block;
            width: 3px;
            height: 1em;
            background-color: white;
            margin-left: 2px;
            animation: blink 1s infinite;
            vertical-align: middle;
        }

        /* Animations */
        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0; }
        }

        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
                box-shadow: 
                    0 6px 25px rgba(108, 92, 231, 0.5),
                    0 0 15px rgba(108, 92, 231, 0.6);
            }
            50% {
                transform: scale(1.05);
                box-shadow: 
                    0 8px 30px rgba(108, 92, 231, 0.7),
                    0 0 20px rgba(108, 92, 231, 0.8);
            }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        @keyframes musicPulse {
            0%, 100% {
                box-shadow: 0 0 0 0 rgba(253, 121, 168, 0.7);
            }
            50% {
                box-shadow: 0 0 0 10px rgba(253, 121, 168, 0);
            }
        }

        @keyframes match {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        @keyframes matchSuccess {
            0% { 
                transform: scale(1);
                box-shadow: 0 0 20px rgba(0, 184, 148, 0.7);
            }
            50% { 
                transform: scale(1.05);
                box-shadow: 0 0 30px rgba(0, 184, 148, 0.9);
            }
            100% { 
                transform: scale(0.95);
                box-shadow: 0 0 20px rgba(0, 184, 148, 0.7);
            }
        }

        @keyframes cardShake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }

        /* Progress Bar */
        .progress-container {
            width: 100%;
            max-width: 500px;
            margin: 15px auto;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            overflow: hidden;
            height: 10px;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(to right, #00b894, #55efc4);
            border-radius: 10px;
            width: 0%;
            transition: width 0.5s ease;
        }

        /* Star Rating */
        .star-rating {
            display: flex;
            justify-content: center;
            gap: 5px;
            margin: 15px 0;
        }

        .star {
            font-size: 1.5rem;
            color: #636e72;
        }

        .star.filled {
            color: #fdcb6e;
            text-shadow: 0 0 10px rgba(253, 203, 110, 0.7);
        }

        /* Responsive adjustments */
        @media (max-width: 1200px) {
            .container {
                max-width: 100%;
            }
        }

        @media (max-width: 992px) {
            .game-title {
                font-size: 2.5rem;
            }
            
            .cards-grid {
                max-width: 550px;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .game-title {
                font-size: 2.2rem;
            }
            
            .game-stats {
                gap: 15px;
            }
            
            .stat {
                min-width: 100px;
                padding: 12px 15px;
            }
            
            .stat-value {
                font-size: 1.8rem;
            }
            
            .cards-grid {
                grid-template-columns: repeat(3, 1fr);
                gap: 12px;
                max-width: 400px;
            }
            
            .game-controls {
                flex-direction: column;
                align-items: center;
            }
            
            .control-btn {
                width: 220px;
                justify-content: center;
            }
            
            .modal-content {
                padding: 25px;
            }
            
            .bot-container {
                bottom: 20px;
                right: 20px;
            }
            
            .bot-assistant {
                width: 300px;
            }
            
            .fixed-back-btn, .fixed-exit-btn {
                top: 20px;
                width: 50px;
                height: 50px;
                font-size: 1.2rem;
            }
            
            .fixed-back-btn {
                left: 20px;
            }
            
            .fixed-exit-btn {
                right: 20px;
            }
            
            .music-toggle {
                bottom: 20px;
                left: 20px;
                width: 55px;
                height: 55px;
            }
        }

        @media (max-width: 576px) {
            .matching-cards-container {
                padding: 5px;
            }
            
            .game-title {
                font-size: 1.8rem;
            }
            
            .stat {
                min-width: 85px;
                padding: 10px 12px;
            }
            
            .stat-value {
                font-size: 1.5rem;
            }
            
            .cards-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
                max-width: 300px;
            }
            
            .game-instructions {
                padding: 15px;
                margin-top: 20px;
            }
            
            .modal-content {
                padding: 20px;
            }
            
            .modal-content h2 {
                font-size: 1.8rem;
            }
            
            .final-score {
                font-size: 2.5rem;
            }
            
            .bot-container {
                bottom: 15px;
                right: 15px;
            }
            
            .bot-assistant {
                width: 280px;
            }
            
            .music-toggle {
                bottom: 15px;
                left: 15px;
                width: 55px;
                height: 55px;
            }
            
            .fixed-back-btn, .fixed-exit-btn {
                top: 15px;
                width: 45px;
                height: 45px;
                font-size: 1.1rem;
            }
            
            .fixed-back-btn {
                left: 15px;
            }
            
            .fixed-exit-btn {
                right: 15px;
            }
        }

        @media (max-width: 360px) {
            .game-title {
                font-size: 1.6rem;
            }
            
            .game-stats {
                gap: 10px;
            }
            
            .stat {
                min-width: 75px;
                padding: 8px 10px;
            }
            
            .stat-value {
                font-size: 1.3rem;
            }
            
            .control-btn {
                width: 200px;
                padding: 12px 18px;
                font-size: 0.9rem;
            }
            
            .bot-assistant {
                width: 260px;
            }
            
            .fixed-back-btn, .fixed-exit-btn {
                width: 40px;
                height: 40px;
                font-size: 1rem;
            }
        }

        /* Performance optimizations */
        .matching-cards-container * {
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        /* Particle effect for background */
        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            overflow: hidden;
        }
        
        .particle {
            position: absolute;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            animation: float 15s infinite linear;
        }

        /* New Styles for Improvements */
        .hint-counter {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--accent-color);
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            font-weight: bold;
        }

        .card.hint-highlight {
            animation: hintPulse 1.5s infinite;
        }

        @keyframes hintPulse {
            0%, 100% { box-shadow: 0 0 10px #fdcb6e; }
            50% { box-shadow: 0 0 25px #fdcb6e; }
        }

        .card.mismatch {
            animation: mismatchShake 0.5s ease;
        }

        @keyframes mismatchShake {
            0%, 100% { transform: rotateY(180deg) translateX(0); }
            25% { transform: rotateY(180deg) translateX(-5px); }
            75% { transform: rotateY(180deg) translateX(5px); }
        }

        .combo-counter {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 2rem;
            font-weight: bold;
            color: #fd79a8;
            text-shadow: 0 0 10px rgba(253, 121, 168, 0.7);
            opacity: 0;
            pointer-events: none;
            z-index: 10;
        }

        .combo-animation {
            animation: comboFloat 1.5s ease-out forwards;
        }

        @keyframes comboFloat {
            0% { opacity: 1; transform: translate(-50%, -50%); }
            100% { opacity: 0; transform: translate(-50%, -100px); }
        }

        .achievement-badge {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            padding: 20px;
            border-radius: var(--border-radius);
            text-align: center;
            box-shadow: var(--card-shadow);
            border: 2px solid var(--accent-color);
            z-index: 3000;
            transition: transform 0.5s ease;
        }

        .achievement-badge.show {
            transform: translate(-50%, -50%) scale(1);
        }

        .achievement-badge h3 {
            color: var(--accent-color);
            margin-bottom: 10px;
        }

        .streak-indicator {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
            margin-top: 10px;
        }

        .streak-fire {
            color: #ff9f43;
            animation: firePulse 1s infinite alternate;
        }

        @keyframes firePulse {
            0% { transform: scale(1); }
            100% { transform: scale(1.2); }
        }

        .card-back.pattern-1 {
            background: linear-gradient(45deg, #6c5ce7 25%, transparent 25%, transparent 75%, #6c5ce7 75%, #6c5ce7),
                        linear-gradient(45deg, #6c5ce7 25%, transparent 25%, transparent 75%, #6c5ce7 75%, #6c5ce7);
            background-size: 20px 20px;
            background-position: 0 0, 10px 10px;
        }

        .card-back.pattern-2 {
            background: radial-gradient(circle at center, #a29bfe 0%, #6c5ce7 100%);
        }

        .card-back.pattern-3 {
            background: 
                linear-gradient(135deg, transparent 0%, transparent 49%, rgba(255,255,255,0.1) 50%, transparent 51%, transparent 100%),
                linear-gradient(45deg, #6c5ce7, #a29bfe);
            background-size: 10px 10px;
        }

        .leaderboard-btn {
            position: fixed;
            bottom: 110px;
            left: 30px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--card-bg);
            border: 1px solid var(--card-glow);
            color: white;
            font-size: 1.4rem;
            cursor: pointer;
            backdrop-filter: blur(15px);
            box-shadow: var(--card-shadow);
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1001;
        }

        .leaderboard-btn:hover {
            transform: scale(1.1);
            background: rgba(255, 255, 255, 0.15);
        }
    </style>
</head>
<body>
    <!-- Background Particles -->
    <div class="particles" id="particles"></div>
    
    <!-- Fixed Navigation Buttons -->
    <button class="fixed-back-btn" id="btnBack">
        <i class="fas fa-arrow-left"></i>
    </button>
    
    <button class="fixed-exit-btn" id="btnExit">
        <i class="fas fa-times"></i>
    </button>

    <!-- Leaderboard Button -->
    <button class="leaderboard-btn" id="leaderboardBtn">
        <i class="fas fa-trophy"></i>
    </button>
    
    <div class="container">
        <!-- Header with title only -->
        <header class="page-header">
            <div class="header-center">
                <h1>Matching Cards</h1>
            </div>
        </header>

        <!-- Matching Cards Game Content -->
        <main class="matching-cards-container">
            <div class="game-header">
                <h2 class="game-title">Memory Challenge</h2>
                <div class="game-stats">
                    <div class="stat">
                        <div class="stat-value" id="movesCount">0</div>
                        <div class="stat-label">MOVES</div>
                    </div>
                    <div class="stat">
                        <div class="stat-value" id="matchesCount">0</div>
                        <div class="stat-label">MATCHES</div>
                    </div>
                    <div class="stat">
                        <div class="stat-value" id="timer">00:00</div>
                        <div class="stat-label">TIME</div>
                        <div class="time-challenge" id="timeChallenge"></div>
                    </div>
                    <div class="stat">
                        <div class="stat-value" id="comboCount">0</div>
                        <div class="stat-label">COMBO</div>
                    </div>
                </div>
                <div class="progress-container">
                    <div class="progress-bar" id="progressBar"></div>
                </div>
            </div>

            <div class="game-area">
                <div class="cards-grid" id="cardsGrid">
                    <!-- Cards will be generated here -->
                </div>
            </div>

            <div class="game-controls">
                <button class="control-btn primary" id="btnNewGame">
                    <i class="fas fa-plus-circle"></i>
                    <span>New Game</span>
                </button>
                <button class="control-btn" id="btnReset">
                    <i class="fas fa-redo"></i>
                    <span>Reset Game</span>
                </button>
                <button class="control-btn" id="btnHint">
                    <i class="fas fa-lightbulb"></i>
                    <span>Hint</span>
                    <div class="hint-counter" id="hintCounter">3</div>
                </button>
            </div>

            <div class="game-instructions">
                <h3>How to Play Matching Cards</h3>
                <ul class="instructions-list">
                    <li>Flip two cards at a time by clicking on them</li>
                    <li>If the cards match, they will stay face up</li>
                    <li>If they don't match, they will flip back after a short delay</li>
                    <li>Try to match all pairs with the fewest moves</li>
                    <li>Complete the game as quickly as possible</li>
                    <li>Use the hint button if you get stuck (max 3 per game)</li>
                    <li>Build combos by making consecutive matches for bonus points!</li>
                </ul>
            </div>
        </main>

        <!-- Game Over Modal -->
        <div class="game-over-modal" id="gameOverModal">
            <div class="modal-content">
                <h2 id="gameResult">Congratulations!</h2>
                <p id="gameResultText">You've matched all the cards!</p>
                <div class="star-rating" id="starRating">
                    <span class="star">★</span>
                    <span class="star">★</span>
                    <span class="star">★</span>
                </div>
                <div class="final-score" id="finalScore">0</div>
                <div class="score-breakdown" id="scoreBreakdown">
                    <!-- Score breakdown will be inserted here -->
                </div>
                <div class="modal-buttons">
                    <button class="control-btn primary" id="btnPlayAgain">
                        <i class="fas fa-redo"></i>
                        <span>Play Again</span>
                    </button>
                    <button class="control-btn" id="btnBackToGames">
                        <i class="fas fa-home"></i>
                        <span>Back to Games</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Game Setup Modal -->
        <div class="game-setup-modal" id="gameSetupModal">
            <div class="setup-content">
                <h2>Game Setup</h2>
                <div class="setup-options">
                    <div class="option-group">
                        <label>Select Difficulty:</label>
                        <div class="difficulty-options">
                            <div class="difficulty-option selected" data-difficulty="easy">
                                <span>Easy (8 cards)</span>
                            </div>
                            <div class="difficulty-option" data-difficulty="medium">
                                <span>Medium (12 cards)</span>
                            </div>
                            <div class="difficulty-option" data-difficulty="hard">
                                <span>Hard (16 cards)</span>
                            </div>
                            <div class="difficulty-option" data-difficulty="expert">
                                <span>Expert (20 cards)</span>
                            </div>
                        </div>
                    </div>
                    <div class="option-group">
                        <label>Choose Card Theme:</label>
                        <div class="theme-options">
                            <div class="theme-option default selected" data-theme="default">
                                <i class="fas fa-gem"></i>
                            </div>
                            <div class="theme-option nature" data-theme="nature">
                                <i class="fas fa-leaf"></i>
                            </div>
                            <div class="theme-option fruit" data-theme="fruit">
                                <i class="fas fa-apple-alt"></i>
                            </div>
                            <div class="theme-option space" data-theme="space">
                                <i class="fas fa-rocket"></i>
                            </div>
                        </div>
                    </div>
                    <div class="option-group">
                        <label>Game Mode:</label>
                        <div class="difficulty-options">
                            <div class="difficulty-option selected" data-mode="normal">
                                <span>Normal</span>
                            </div>
                            <div class="difficulty-option" data-mode="time-attack">
                                <span>Time Attack</span>
                            </div>
                            <div class="difficulty-option" data-mode="memory-master">
                                <span>Memory Master</span>
                            </div>
                        </div>
                    </div>
                </div>
                <button class="control-btn primary" id="btnStartGame">
                    <i class="fas fa-play"></i>
                    <span>Start Game</span>
                </button>
            </div>
        </div>

        <!-- Achievement Badge -->
        <div class="achievement-badge" id="achievementBadge">
            <h3 id="achievementTitle">Achievement Unlocked!</h3>
            <p id="achievementDesc">You've earned an achievement!</p>
        </div>

        <!-- Bot Assistant -->
        <div class="bot-container">
            <button class="bot-toggle" id="botToggle">
                <i class="fas fa-question-circle"></i>
            </button>
            <div class="bot-assistant" id="botAssistant">
                <div class="bot-header">
                    <h3>MO11 - <a href="https://www.instagram.com/mo_little11?igsh=MTZsdWhpeXg5ZGttYQ%3D%3D&utm_source=qr" style="color: #fd79a8; text-decoration: none;">#1011</a></h3>
                    <button class="bot-close" id="botClose">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="bot-content">
                    <div class="bot-messages">
                        <div class="bot-message">
                            <p>Need help with Matching Cards? I can assist you!</p>
                        </div>
                    </div>
                    <div class="bot-questions">
                        <button class="bot-question" data-question="matching-rules">
                            <span>How to play matching cards?</span>
                        </button>
                        <button class="bot-question" data-question="matching-strategy">
                            <span>Memory improvement tips</span>
                        </button>
                        <button class="bot-question" data-question="matching-scoring">
                            <span>How is scoring calculated?</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Background Music -->
        <audio id="backgroundMusic" loop>
            <source src="assets/audio/background3.mp3" type="audio/mpeg">
            Your browser does not support the audio element.
        </audio>
        <button class="music-toggle" id="musicToggle">
            <i class="fas fa-volume-up"></i>
        </button>

        <!-- Game Sounds -->
        <audio id="flipSound" preload="auto">
            <source src="assets/audio/checkers-move.mp3" type="audio/mpeg">
        </audio>
        <audio id="matchSound" preload="auto">
            <source src="assets/audio/king.mp3" type="audio/mpeg">
        </audio>
        <audio id="mismatchSound" preload="auto">
            <source src="assets/audio/error.mp3" type="audio/mpeg">
        </audio>
        <audio id="gameOverSound" preload="auto">
            <source src="assets/audio/game-over.mp3" type="audio/mpeg">
        </audio>
        <audio id="comboSound" preload="auto">
            <source src="assets/audio/eating.mp3" type="audio/mpeg">
        </audio>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // ===== GAME VARIABLES =====
            const cardsGrid = document.getElementById('cardsGrid');
            const movesCountElement = document.getElementById('movesCount');
            const matchesCountElement = document.getElementById('matchesCount');
            const timerElement = document.getElementById('timer');
            const timeChallengeElement = document.getElementById('timeChallenge');
            const progressBar = document.getElementById('progressBar');
            const gameOverModal = document.getElementById('gameOverModal');
            const gameSetupModal = document.getElementById('gameSetupModal');
            const gameResultElement = document.getElementById('gameResult');
            const gameResultTextElement = document.getElementById('gameResultText');
            const finalScoreElement = document.getElementById('finalScore');
            const scoreBreakdownElement = document.getElementById('scoreBreakdown');
            const starRatingElement = document.getElementById('starRating');
            const hintCounterElement = document.getElementById('hintCounter');
            const comboCountElement = document.getElementById('comboCount');
            const achievementBadge = document.getElementById('achievementBadge');
            const achievementTitle = document.getElementById('achievementTitle');
            const achievementDesc = document.getElementById('achievementDesc');
            
            // Game state
            let cards = [];
            let flippedCards = [];
            let matchedPairs = 0;
            let movesCount = 0;
            let gameActive = false;
            let timerInterval;
            let seconds = 0;
            let minutes = 0;
            let totalPairs = 4; // Default to easy difficulty
            let cardTheme = 'default';
            let canFlip = true;
            let timeLimit = 0; // Time limit in seconds
            let timeChallengeActive = false;
            let hintsUsed = 0;
            let maxHints = 3;
            let comboCount = 0;
            let consecutiveMatches = 0;
            let gameMode = 'normal'; // normal, time-attack, memory-master
            let leaderboard = JSON.parse(localStorage.getItem('matchingCardsLeaderboard')) || [];
            
            // Card symbols based on theme - including MO image
            const cardSymbols = {
                default: ['🍎', '🍌', '🍒', '🍇', '🍊', '🍓', '🍑', '🍍', '🥝', '🍉', '🥭', '🫐'],
                nature: ['🌻', '🌹', '🌼', '🌸', '🌺', '🍀', '🌴', '🌵', '🌲', '🌳', '🍁', '🌾'],
                fruit: ['🍏', '🍐', '🍋', '🍈', '🍅', '🥥', '🥑', '🍆', '🥔', '🥕', '🌽', '🥒'],
                space: ['🚀', '🛸', '🛰️', '🌍', '🌕', '⭐', '🌟', '💫', '☄️', '🌌', '👽', '🪐']
            };
            
            // Bot typing state
            let isBotTyping = false;
            
            // ===== GAME FUNCTIONS =====
            function initGame() {
                // Reset game state
                cardsGrid.innerHTML = '';
                cards = [];
                flippedCards = [];
                matchedPairs = 0;
                movesCount = 0;
                seconds = 0;
                minutes = 0;
                gameActive = true;
                canFlip = true;
                timeChallengeActive = false;
                hintsUsed = 0;
                comboCount = 0;
                consecutiveMatches = 0;
                
                // Update UI
                movesCountElement.textContent = movesCount;
                matchesCountElement.textContent = matchedPairs;
                comboCountElement.textContent = comboCount;
                updateTimer();
                updateProgressBar();
                timeChallengeElement.textContent = '';
                timeChallengeElement.className = 'time-challenge';
                hintCounterElement.textContent = maxHints - hintsUsed;
                
                // Enable hint button
                document.getElementById('btnHint').disabled = false;
                
                // Clear any existing timer
                clearInterval(timerInterval);
                
                // Create cards based on difficulty
                createCards();
                
                // Set time limit based on difficulty and game mode
                setTimeLimit();
                
                // Auto-play background music
                autoPlayMusic();
                
                // Ensure game over modal is hidden
                gameOverModal.classList.remove('active');
                
                // Start the timer
                timerInterval = setInterval(updateTimer, 1000);
            }
            
            function setTimeLimit() {
                // Set time limits based on difficulty and game mode
                if (gameMode === 'time-attack') {
                    if (totalPairs === 4) { // Easy
                        timeLimit = 60; // 1 minute
                    } else if (totalPairs === 6) { // Medium
                        timeLimit = 90; // 1.5 minutes
                    } else if (totalPairs === 8) { // Hard
                        timeLimit = 120; // 2 minutes
                    } else { // Expert
                        timeLimit = 150; // 2.5 minutes
                    }
                } else if (gameMode === 'memory-master') {
                    // Memory master mode - no time limit but limited moves
                    timeLimit = 0;
                    timeChallengeElement.textContent = 'Limited Moves Mode';
                } else {
                    // Normal mode
                    if (totalPairs === 4) { // Easy
                        timeLimit = 120; // 2 minutes
                    } else if (totalPairs === 6) { // Medium
                        timeLimit = 180; // 3 minutes
                    } else if (totalPairs === 8) { // Hard
                        timeLimit = 240; // 4 minutes
                    } else { // Expert
                        timeLimit = 300; // 5 minutes
                    }
                }
                
                // Update time challenge display
                if (timeLimit > 0) {
                    const timeLimitMinutes = Math.floor(timeLimit / 60);
                    const timeLimitSeconds = timeLimit % 60;
                    timeChallengeElement.textContent = `Time Challenge: ${timeLimitMinutes}:${timeLimitSeconds < 10 ? '0' : ''}${timeLimitSeconds}`;
                }
            }
            
            function createCards() {
                // Get symbols for current theme
                const symbols = cardSymbols[cardTheme].slice(0, totalPairs - 1);
                
                // Add MO image as one of the pairs
                symbols.push('MO');
                
                // Duplicate symbols to create pairs
                const cardSymbolsDuplicated = [...symbols, ...symbols];
                
                // Shuffle the cards
                shuffleArray(cardSymbolsDuplicated);
                
                // Create card elements
                for (let i = 0; i < cardSymbolsDuplicated.length; i++) {
                    const card = document.createElement('div');
                    card.className = 'card';
                    card.dataset.index = i;
                    card.dataset.symbol = cardSymbolsDuplicated[i];
                    
                    const cardFront = document.createElement('div');
                    cardFront.className = 'card-front';
                    
                    // Check if this is the MO card
                    if (cardSymbolsDuplicated[i] === 'MO') {
                        const moImage = document.createElement('img');
                        moImage.src = 'assets/images/card.jpg';
                        moImage.alt = 'MO';
                        moImage.onerror = function() {
                            // If image fails to load, show text instead
                            this.style.display = 'none';
                            cardFront.textContent = 'MO';
                        };
                        cardFront.appendChild(moImage);
                    } else {
                        cardFront.textContent = cardSymbolsDuplicated[i];
                    }
                    
                    const cardBack = document.createElement('div');
                    cardBack.className = 'card-back';
                    
                    // Add different patterns to card backs
                    const patternClass = `pattern-${Math.floor(Math.random() * 3) + 1}`;
                    cardBack.classList.add(patternClass);
                    
                    const icon = document.createElement('i');
                    icon.className = 'fas fa-question';
                    cardBack.appendChild(icon);
                    
                    card.appendChild(cardFront);
                    card.appendChild(cardBack);
                    
                    card.addEventListener('click', () => flipCard(card));
                    
                    cardsGrid.appendChild(card);
                    cards.push(card);
                }
                
                // Adjust grid layout based on difficulty
                adjustGridLayout();
            }
            
            function adjustGridLayout() {
                // Adjust grid layout based on screen size and difficulty
                const screenWidth = window.innerWidth;
                
                if (screenWidth <= 576) {
                    // Mobile devices - always use 2 columns
                    cardsGrid.style.gridTemplateColumns = 'repeat(2, 1fr)';
                    cardsGrid.style.maxWidth = '300px';
                } else if (screenWidth <= 768) {
                    // Tablets
                    if (totalPairs === 4) {
                        cardsGrid.style.gridTemplateColumns = 'repeat(2, 1fr)';
                        cardsGrid.style.maxWidth = '300px';
                    } else if (totalPairs === 6) {
                        cardsGrid.style.gridTemplateColumns = 'repeat(3, 1fr)';
                        cardsGrid.style.maxWidth = '350px';
                    } else if (totalPairs === 8) {
                        cardsGrid.style.gridTemplateColumns = 'repeat(4, 1fr)';
                        cardsGrid.style.maxWidth = '400px';
                    } else {
                        cardsGrid.style.gridTemplateColumns = 'repeat(5, 1fr)';
                        cardsGrid.style.maxWidth = '450px';
                    }
                } else {
                    // Desktop
                    if (totalPairs === 4) {
                        cardsGrid.style.gridTemplateColumns = 'repeat(2, 1fr)';
                        cardsGrid.style.maxWidth = '300px';
                    } else if (totalPairs === 6) {
                        cardsGrid.style.gridTemplateColumns = 'repeat(3, 1fr)';
                        cardsGrid.style.maxWidth = '400px';
                    } else if (totalPairs === 8) {
                        cardsGrid.style.gridTemplateColumns = 'repeat(4, 1fr)';
                        cardsGrid.style.maxWidth = '500px';
                    } else {
                        cardsGrid.style.gridTemplateColumns = 'repeat(5, 1fr)';
                        cardsGrid.style.maxWidth = '550px';
                    }
                }
                
                // Adjust card size based on screen size
                const cardSize = Math.min(screenWidth * 0.15, 120);
                document.querySelectorAll('.card').forEach(card => {
                    card.style.minWidth = `${cardSize}px`;
                });
            }
            
            function flipCard(card) {
                // Check if card can be flipped
                if (!gameActive || !canFlip || card.classList.contains('flipped') || card.classList.contains('matched')) {
                    return;
                }
                
                // Play flip sound
                playSound('flipSound');
                
                // Flip the card
                card.classList.add('flipped');
                flippedCards.push(card);
                
                // Check for match when two cards are flipped
                if (flippedCards.length === 2) {
                    canFlip = false;
                    movesCount++;
                    movesCountElement.textContent = movesCount;
                    
                    const card1 = flippedCards[0];
                    const card2 = flippedCards[1];
                    
                    if (card1.dataset.symbol === card2.dataset.symbol) {
                        // Match found
                        setTimeout(() => {
                            card1.classList.add('matched');
                            card2.classList.add('matched');
                            flippedCards = [];
                            matchedPairs++;
                            matchesCountElement.textContent = matchedPairs;
                            updateProgressBar();
                            playSound('matchSound');
                            
                            // Handle combo system
                            consecutiveMatches++;
                            if (consecutiveMatches > 1) {
                                comboCount += consecutiveMatches;
                                comboCountElement.textContent = comboCount;
                                
                                // Show combo animation
                                showComboAnimation(consecutiveMatches);
                                
                                // Play combo sound
                                if (consecutiveMatches >= 3) {
                                    playSound('comboSound');
                                }
                            }
                            
                            // Check for achievements
                            checkAchievements();
                            
                            canFlip = true;
                            
                            // Check for game completion
                            if (matchedPairs === totalPairs) {
                                endGame();
                            }
                        }, 500);
                    } else {
                        // No match
                        setTimeout(() => {
                            card1.classList.remove('flipped');
                            card2.classList.remove('flipped');
                            flippedCards = [];
                            playSound('mismatchSound');
                            
                            // Add shake animation for mismatch
                            card1.classList.add('mismatch');
                            card2.classList.add('mismatch');
                            setTimeout(() => {
                                card1.classList.remove('mismatch');
                                card2.classList.remove('mismatch');
                            }, 500);
                            
                            // Reset combo
                            consecutiveMatches = 0;
                            
                            canFlip = true;
                        }, 1000);
                    }
                }
            }
            
            function showComboAnimation(combo) {
                const comboElement = document.createElement('div');
                comboElement.className = 'combo-counter combo-animation';
                comboElement.textContent = `COMBO x${combo}!`;
                document.querySelector('.game-area').appendChild(comboElement);
                
                setTimeout(() => {
                    comboElement.remove();
                }, 1500);
            }
            
            function checkAchievements() {
                // Check for various achievements
                if (matchedPairs === totalPairs && movesCount <= totalPairs) {
                    showAchievement('Perfect Memory', 'You completed the game with perfect moves!');
                } else if (consecutiveMatches >= 5) {
                    showAchievement('Memory Master', 'You made 5 consecutive matches!');
                } else if (comboCount >= 10) {
                    showAchievement('Combo King', 'You reached a combo of 10!');
                } else if (matchedPairs === totalPairs && seconds < 30) {
                    showAchievement('Speed Demon', 'You completed the game in under 30 seconds!');
                }
            }
            
            function showAchievement(title, description) {
                achievementTitle.textContent = title;
                achievementDesc.textContent = description;
                achievementBadge.classList.add('show');
                
                setTimeout(() => {
                    achievementBadge.classList.remove('show');
                }, 3000);
            }
            
            function updateTimer() {
                // Only update timer if game is active
                if (!gameActive) return;
                
                seconds++;
                if (seconds === 60) {
                    seconds = 0;
                    minutes++;
                }
                
                const formattedSeconds = seconds < 10 ? `0${seconds}` : seconds;
                const formattedMinutes = minutes < 10 ? `0${minutes}` : minutes;
                
                timerElement.textContent = `${formattedMinutes}:${formattedSeconds}`;
                
                // Check time challenge
                if (timeLimit > 0) {
                    const totalSeconds = minutes * 60 + seconds;
                    const timeLeft = timeLimit - totalSeconds;
                    
                    if (timeLeft <= 30 && timeLeft > 0 && !timeChallengeActive) {
                        timeChallengeActive = true;
                        timeChallengeElement.classList.add('time-critical');
                    }
                    
                    // Check if time is up
                    if (totalSeconds >= timeLimit) {
                        endGame(true);
                    }
                }
                
                // Check for memory master mode (limited moves)
                if (gameMode === 'memory-master' && movesCount >= totalPairs * 3) {
                    endGame(true);
                }
            }
            
            function updateProgressBar() {
                const progress = (matchedPairs / totalPairs) * 100;
                progressBar.style.width = `${progress}%`;
            }
            
            function endGame(timeUp = false) {
                gameActive = false;
                clearInterval(timerInterval);
                
                // Only play game over sound if the game was actually played
                if (movesCount > 0 || matchedPairs > 0) {
                    playSound('gameOverSound');
                }
                
                // Calculate score
                const timeScore = timeLimit > 0 ? Math.max(0, 1000 - (minutes * 60 + seconds) * 5) : 500;
                const movesScore = Math.max(0, 500 - movesCount * 10);
                const timeBonus = timeUp ? 0 : 500;
                const hintPenalty = hintsUsed * 50;
                const comboBonus = comboCount * 20;
                const difficultyMultiplier = totalPairs === 4 ? 1 : totalPairs === 6 ? 1.5 : totalPairs === 8 ? 2 : 2.5;
                const totalScore = Math.floor((timeScore + movesScore + timeBonus + comboBonus - hintPenalty) * difficultyMultiplier);
                
                // Calculate star rating
                let stars = 3;
                if (timeUp) stars = 1;
                else if (movesCount > totalPairs * 3) stars = 2;
                
                // Update star rating display
                const starElements = starRatingElement.querySelectorAll('.star');
                starElements.forEach((star, index) => {
                    if (index < stars) {
                        star.classList.add('filled');
                    } else {
                        star.classList.remove('filled');
                    }
                });
                
                // Update modal content
                if (timeUp) {
                    if (gameMode === 'memory-master') {
                        gameResultElement.textContent = 'Out of Moves!';
                        gameResultTextElement.textContent = `You used all your moves! You matched ${matchedPairs} out of ${totalPairs} pairs.`;
                    } else {
                        gameResultElement.textContent = 'Time\'s Up!';
                        gameResultTextElement.textContent = `You ran out of time! You matched ${matchedPairs} out of ${totalPairs} pairs.`;
                    }
                } else {
                    gameResultElement.textContent = 'Congratulations!';
                    gameResultTextElement.textContent = `You matched all ${totalPairs} pairs in ${movesCount} moves and ${minutes}:${seconds < 10 ? '0' + seconds : seconds}!`;
                }
                finalScoreElement.textContent = totalScore;
                
                // Update score breakdown
                scoreBreakdownElement.innerHTML = `
                    <div class="score-item">
                        <span class="score-label">Time Score:</span>
                        <span class="score-value">${timeScore}</span>
                    </div>
                    <div class="score-item">
                        <span class="score-label">Moves Score:</span>
                        <span class="score-value">${movesScore}</span>
                    </div>
                    <div class="score-item">
                        <span class="score-label">Time Bonus:</span>
                        <span class="score-value">${timeBonus}</span>
                    </div>
                    <div class="score-item">
                        <span class="score-label">Combo Bonus:</span>
                        <span class="score-value">${comboBonus}</span>
                    </div>
                    <div class="score-item">
                        <span class="score-label">Hint Penalty:</span>
                        <span class="score-value">-${hintPenalty}</span>
                    </div>
                    <div class="score-item">
                        <span class="score-label">Difficulty Multiplier:</span>
                        <span class="score-value">x${difficultyMultiplier}</span>
                    </div>
                `;
                
                // Save to leaderboard if score is high enough
                saveToLeaderboard(totalScore, minutes * 60 + seconds, movesCount);
                
                // Show game over modal
                setTimeout(() => {
                    gameOverModal.classList.add('active');
                }, 1000);
            }
            
            function saveToLeaderboard(score, time, moves) {
                const entry = {
                    score: score,
                    time: time,
                    moves: moves,
                    difficulty: totalPairs,
                    date: new Date().toLocaleDateString()
                };
                
                leaderboard.push(entry);
                
                // Sort by score (descending)
                leaderboard.sort((a, b) => b.score - a.score);
                
                // Keep only top 10 scores
                leaderboard = leaderboard.slice(0, 10);
                
                // Save to localStorage
                localStorage.setItem('matchingCardsLeaderboard', JSON.stringify(leaderboard));
            }
            
            function showLeaderboard() {
                // Create leaderboard modal
                const leaderboardModal = document.createElement('div');
                leaderboardModal.className = 'game-over-modal active';
                leaderboardModal.innerHTML = `
                    <div class="modal-content">
                        <h2>Leaderboard</h2>
                        <div class="score-breakdown" style="max-height: 300px; overflow-y: auto;">
                            ${leaderboard.length > 0 ? 
                                leaderboard.map((entry, index) => `
                                    <div class="score-item" style="padding: 10px; border-bottom: 1px solid rgba(255,255,255,0.1);">
                                        <div style="display: flex; justify-content: space-between; width: 100%;">
                                            <span>#${index + 1}</span>
                                            <span>Score: ${entry.score}</span>
                                            <span>Time: ${Math.floor(entry.time / 60)}:${entry.time % 60 < 10 ? '0' : ''}${entry.time % 60}</span>
                                            <span>Moves: ${entry.moves}</span>
                                        </div>
                                        <div style="font-size: 0.8rem; color: #a29bfe; margin-top: 5px;">
                                            ${entry.date} - ${entry.difficulty * 2} cards
                                        </div>
                                    </div>
                                `).join('') : 
                                '<p style="text-align: center; padding: 20px;">No scores yet. Play a game to get on the leaderboard!</p>'
                            }
                        </div>
                        <div class="modal-buttons">
                            <button class="control-btn primary" id="btnCloseLeaderboard">
                                <i class="fas fa-times"></i>
                                <span>Close</span>
                            </button>
                        </div>
                    </div>
                `;
                
                document.body.appendChild(leaderboardModal);
                
                // Add event listener to close button
                document.getElementById('btnCloseLeaderboard').addEventListener('click', function() {
                    document.body.removeChild(leaderboardModal);
                });
            }
            
            function resetGame() {
                if (gameActive) {
                    clearInterval(timerInterval);
                }
                initGame();
            }
            
            function showHint() {
                if (!gameActive || flippedCards.length > 0 || hintsUsed >= maxHints) return;
                
                // Find two unmatched cards that are the same
                const unmatchedCards = cards.filter(card => !card.classList.contains('matched'));
                const cardMap = {};
                let hintCards = [];
                
                for (const card of unmatchedCards) {
                    const symbol = card.dataset.symbol;
                    if (cardMap[symbol]) {
                        hintCards = [cardMap[symbol], card];
                        break;
                    } else {
                        cardMap[symbol] = card;
                    }
                }
                
                if (hintCards.length === 2) {
                    hintsUsed++;
                    hintCounterElement.textContent = maxHints - hintsUsed;
                    
                    // Temporarily highlight the hint cards
                    hintCards[0].classList.add('hint-highlight');
                    hintCards[1].classList.add('hint-highlight');
                    
                    setTimeout(() => {
                        hintCards[0].classList.remove('hint-highlight');
                        hintCards[1].classList.remove('hint-highlight');
                    }, 2000);
                    
                    // Disable hint button if max hints reached
                    if (hintsUsed >= maxHints) {
                        document.getElementById('btnHint').disabled = true;
                    }
                }
            }
            
            function shuffleArray(array) {
                for (let i = array.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [array[i], array[j]] = [array[j], array[i]];
                }
                return array;
            }
            
            function playSound(soundId) {
                const sound = document.getElementById(soundId);
                if (sound) {
                    sound.currentTime = 0;
                    sound.play().catch(e => console.log("Sound play prevented:", e));
                }
            }
            
            function autoPlayMusic() {
                const backgroundMusic = document.getElementById('backgroundMusic');
                const musicToggle = document.getElementById('musicToggle');
                
                // Try to play background music automatically
                const playPromise = backgroundMusic.play();
                
                if (playPromise !== undefined) {
                    playPromise.then(() => {
                        // Auto-play started successfully
                        musicToggle.classList.add('playing');
                    }).catch(error => {
                        // Auto-play was prevented, show the play button
                        console.log("Auto-play prevented:", error);
                        musicToggle.classList.remove('playing');
                    });
                }
            }
            
            // Bot typing function
            function typeMessage(message, messageDiv, callback) {
                if (isBotTyping) return;
                
                isBotTyping = true;
                let index = 0;
                messageDiv.innerHTML = '';
                
                const typingInterval = setInterval(() => {
                    if (index < message.length) {
                        messageDiv.innerHTML += message.charAt(index);
                        index++;
                        
                        // Scroll to bottom of messages
                        const messages = document.querySelector('.bot-messages');
                        messages.scrollTop = messages.scrollHeight;
                    } else {
                        clearInterval(typingInterval);
                        isBotTyping = false;
                        if (callback) callback();
                    }
                }, 30);
            }
            
            // ===== EVENT LISTENERS =====
            document.getElementById('btnNewGame').addEventListener('click', function() {
                gameSetupModal.style.display = 'flex';
            });
            
            document.getElementById('btnReset').addEventListener('click', resetGame);
            document.getElementById('btnHint').addEventListener('click', showHint);
            
            // Difficulty selection
            document.querySelectorAll('.difficulty-option[data-difficulty]').forEach(option => {
                option.addEventListener('click', function() {
                    document.querySelectorAll('.difficulty-option[data-difficulty]').forEach(opt => opt.classList.remove('selected'));
                    this.classList.add('selected');
                    
                    const difficulty = this.getAttribute('data-difficulty');
                    if (difficulty === 'easy') {
                        totalPairs = 4;
                    } else if (difficulty === 'medium') {
                        totalPairs = 6;
                    } else if (difficulty === 'hard') {
                        totalPairs = 8;
                    } else {
                        totalPairs = 10;
                    }
                });
            });
            
            // Game mode selection
            document.querySelectorAll('.difficulty-option[data-mode]').forEach(option => {
                option.addEventListener('click', function() {
                    document.querySelectorAll('.difficulty-option[data-mode]').forEach(opt => opt.classList.remove('selected'));
                    this.classList.add('selected');
                    gameMode = this.getAttribute('data-mode');
                });
            });
            
            // Theme selection
            document.querySelectorAll('.theme-option').forEach(option => {
                option.addEventListener('click', function() {
                    document.querySelectorAll('.theme-option').forEach(opt => opt.classList.remove('selected'));
                    this.classList.add('selected');
                    cardTheme = this.getAttribute('data-theme');
                });
            });
            
            document.getElementById('btnStartGame').addEventListener('click', function() {
                gameSetupModal.style.display = 'none';
                initGame();
            });
            
            document.getElementById('btnPlayAgain').addEventListener('click', function() {
                gameOverModal.classList.remove('active');
                initGame();
            });
            
            document.getElementById('btnBackToGames').addEventListener('click', function() {
                window.location.href = 'games.html';
            });
            
            document.getElementById('btnBack').addEventListener('click', function() {
                window.location.href = 'games.html';
            });
            
            document.getElementById('btnExit').addEventListener('click', function() {
                if (confirm('Are you sure you want to exit GameNest?')) {
                    window.location.href = 'index.html';
                }
            });
            
            // Leaderboard button
            document.getElementById('leaderboardBtn').addEventListener('click', showLeaderboard);
            
            // Bot Assistant Functionality
            document.getElementById('botToggle').addEventListener('click', function() {
                document.getElementById('botAssistant').classList.toggle('active');
            });
            
            document.getElementById('botClose').addEventListener('click', function() {
                document.getElementById('botAssistant').classList.remove('active');
            });
            
            // Music Toggle Functionality
            const musicToggle = document.getElementById('musicToggle');
            const backgroundMusic = document.getElementById('backgroundMusic');
            
            musicToggle.addEventListener('click', function() {
                if (backgroundMusic.paused) {
                    backgroundMusic.play();
                    musicToggle.classList.add('playing');
                } else {
                    backgroundMusic.pause();
                    musicToggle.classList.remove('playing');
                }
            });
            
            // Bot Questions
            document.querySelectorAll('.bot-question').forEach(button => {
                button.addEventListener('click', function() {
                    const question = this.getAttribute('data-question');
                    const messages = document.querySelector('.bot-messages');
                    
                    let response = '';
                    switch(question) {
                        case 'matching-rules':
                            response = 'Matching Cards is a memory game where you flip two cards at a time to find matching pairs. If the cards match, they stay face up. If not, they flip back over. The goal is to match all pairs with the fewest moves and in the shortest time. Try to build combos by making consecutive matches for bonus points!';
                            break;
                        case 'matching-strategy':
                            response = 'Memory improvement tips: 1) Focus on card positions rather than individual cards. 2) Create mental associations between card positions. 3) Try to remember pairs you\'ve seen before. 4) Start from one corner and work systematically. 5) Use the hint feature if you get stuck (max 3 per game). 6) Build combos by making consecutive matches.';
                            break;
                        case 'matching-scoring':
                            response = 'Scoring is based on time, moves, and combos. You get more points for completing the game quickly and with fewer moves. The maximum base score is 1500 points (1000 for time + 500 for moves). You earn bonus points for combos and lose points for using hints. Higher difficulty levels multiply your final score.';
                            break;
                    }
                    
                    const messageDiv = document.createElement('div');
                    messageDiv.className = 'bot-message';
                    messages.appendChild(messageDiv);
                    
                    // Show typing indicator
                    const typingIndicator = document.createElement('div');
                    typingIndicator.className = 'bot-message';
                    typingIndicator.innerHTML = '<p>MO11 is typing<span class="typing-cursor"></span></p>';
                    messages.appendChild(typingIndicator);
                    messages.scrollTop = messages.scrollHeight;
                    
                    // Remove typing indicator and type the actual message
                    setTimeout(() => {
                        messages.removeChild(typingIndicator);
                        typeMessage(response, messageDiv);
                    }, 1000);
                });
            });
            
            // Create background particles
            function createParticles() {
                const particlesContainer = document.getElementById('particles');
                const particleCount = 30;
                
                for (let i = 0; i < particleCount; i++) {
                    const particle = document.createElement('div');
                    particle.className = 'particle';
                    
                    const size = Math.random() * 5 + 2;
                    particle.style.width = `${size}px`;
                    particle.style.height = `${size}px`;
                    
                    particle.style.left = `${Math.random() * 100}%`;
                    particle.style.top = `${Math.random() * 100}%`;
                    
                    particle.style.animationDuration = `${Math.random() * 20 + 10}s`;
                    particle.style.animationDelay = `${Math.random() * 5}s`;
                    
                    particlesContainer.appendChild(particle);
                }
            }
            
            // Window resize handler
            window.addEventListener('resize', function() {
                if (gameActive) {
                    adjustGridLayout();
                }
            });
            
            // ===== INITIALIZATION =====
            createParticles();
            
            // Show setup modal on page load
            gameSetupModal.style.display = 'flex';
            
            // Initialize timer display
            timerElement.textContent = '00:00';
            
            // Ensure game over modal is hidden on page load
            gameOverModal.classList.remove('active');
            gameOverModal.style.display = 'none';
        });
    </script>
</body>
</html>